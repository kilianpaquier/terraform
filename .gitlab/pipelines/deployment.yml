# Code generated by kickr; DO NOT EDIT.

---
include:

  # Terraform template
  # https://gitlab.com/to-be-continuous/terraform
  - project: to-be-continuous/terraform
    ref: d58443583d11e1ef3ac279911501de126088caaa # 9.0.0
    file: templates/gitlab-ci-terraform.yml

variables:
  TF_IMAGE: ghcr.io/opentofu/opentofu:latest

  TF_FMT_ENABLED: "true"
  TF_TRIVY_ARGS: --disable-telemetry --skip-version-check . --ignorefile .trivyignore.yaml
  TF_VALIDATE_ENABLED: "true"

  TF_REVIEW_ENABLED: "false"
  TF_INTEG_ENABLED: "false"
  TF_STAGING_ENABLED: "false"
  TF_PROD_ENABLED: "true"

.tf-workspace:
  variables:
    TF_BASE_ADDRESS: ${CI_API_V4_URL}/projects/${CI_PROJECT_ID}/terraform/state
  parallel:
    matrix:
      - TF_PROJECT_DIR: modules/git
        # see https://gitlab.com/to-be-continuous/terraform/-/blob/master/templates/gitlab-ci-terraform.yml?ref_type=heads#L774
        TF_ADDRESS: ${TF_BASE_ADDRESS}/ff76aae2.${CI_ENVIRONMENT_SLUG}
      - TF_PROJECT_DIR: modules/cloud
        # see https://gitlab.com/to-be-continuous/terraform/-/blob/master/templates/gitlab-ci-terraform.yml?ref_type=heads#L774
        TF_ADDRESS: ${TF_BASE_ADDRESS}/771c5852.${CI_ENVIRONMENT_SLUG}
